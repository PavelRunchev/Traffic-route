System.register(["./index-legacy.js"],(function(e,t){"use strict";var s,r,o,n;return{setters:[e=>{s=e.bG,r=e.s,o=e.bH,n=e.X}],execute:function(){function t(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function a(e){const[s,r]=function(e){const t=o(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[n,a]=t(s);return[n,a,r]}e({addOrUpdateResources:async function(e,o,n,a){const c=new Map;for(const{resource:s,content:i,compress:u,access:p}of o){if(!s.hasPath())throw new r(`portal-item-resource-${n}:invalid-path`,"Resource does not have a valid path");const[e,o]=t(s.path),a=`${e}/${u??""}/${p??""}`;c.has(a)||c.set(a,{prefix:e,compress:u,access:p,files:[]}),c.get(a).files.push({fileName:o,content:i})}await e.load(a);const l=s(e.userItemUrl,"add"===n?"addResources":"updateResources");for(const{prefix:t,compress:s,access:r,files:i}of c.values()){const o=25;for(let n=0;n<i.length;n+=o){const c=i.slice(n,n+o),u=new FormData;t&&"."!==t&&u.append("resourcesPrefix",t),s&&u.append("compress","true"),r&&u.append("access",r);let p=0;for(const{fileName:e,content:t}of c)u.append("file"+ ++p,t,e);u.append("f","json"),await e.portal.request(l,{method:"post",body:u,signal:a?.signal})}}},contentToBlob:async function(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(await n(e.url,{responseType:"blob"})).data},fetchResources:async function(e,t={},r){await e.load(r);const o=s(e.itemUrl,"resources"),{start:n=1,num:a=10,sortOrder:c="asc",sortField:l="resource"}=t,i={query:{start:n,num:a,sortOrder:c,sortField:l,token:e.apiKey},signal:r?.signal},u=await e.portal.request(o,i);return{total:u.total,nextStart:u.nextStart,resources:u.resources.map((({created:t,size:s,resource:r})=>({created:new Date(t),size:s,resource:e.resourceFromPath(r)})))}},getSiblingOfSameType:function(e,t){if(!e.hasPath())return null;const[r,,o]=a(e.path);return e.portalItem.resourceFromPath(s(r,t+o))},getSiblingOfSameTypeI:function(e,t){if(!e.hasPath())return null;const[r,,o]=a(e.path);return e.portalItem.resourceFromPath(s(r,t+o))},removeAllResources:async function(e,t){await e.load(t);const r=s(e.userItemUrl,"removeResources");return e.portal.request(r,{method:"post",query:{deleteAll:!0},signal:t?.signal})},removeResource:async function(e,t,o){if(!t.hasPath())throw new r("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(o);const n=s(e.userItemUrl,"removeResources");await e.portal.request(n,{method:"post",query:{resource:t.path},signal:o?.signal}),t.portalItem=null},splitPrefixFileNameAndExtension:a})}}}));
