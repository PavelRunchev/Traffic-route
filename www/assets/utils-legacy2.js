System.register(["./index-legacy.js","./enums-legacy2.js","./AttributeStore-legacy.js"],(function(t,e){"use strict";var r,i,a,n;return{setters:[t=>{r=t.n,i=t.S},t=>{a=t.d},t=>{n=t.e}],execute:function(){function e(t,e){const{width:r,height:a,getFrame:n}=t,s=t.frameDurations.slice(),o=s.pop();return s.push(i(o+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:s,getFrame:n,width:r,height:a}}t("f",(function(t,e,i,a){const n=null==e.playAnimation||e.playAnimation,s=o(t,e,i,a);let m,u=s.timeToFrame;return function t(){m=n?setTimeout((()=>{s.nextFrame(),u=s.timeToFrame,t()}),u):void 0}(),r((()=>n&&clearTimeout(m)))}));class s{constructor(t,e,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;e>a;)a+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case a.None:this._currentFrame-=this._direction;break;case a.Loop:this._currentFrame=0;break;case a.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case a.None:this._currentFrame-=this._direction;break;case a.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case a.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}function o(t,r,o,m){let u,{repeatType:h}=r;if(null==h&&(h=a.Loop),!0===r.reverseAnimation&&(t=function(t){const{width:e,height:r}=t,i=t.frameDurations.reverse();return{frameCount:t.frameCount,duration:t.duration,frameDurations:i,getFrame:e=>{const r=t.frameDurations.length-1-e;return t.getFrame(r)},width:e,height:r}}(t)),null!=r.duration&&(t=function(t,e){const{width:r,height:a,getFrame:n}=t,s=e/t.duration,o=t.frameDurations.map((t=>i(t*s)));return{frameCount:t.frameCount,duration:t.duration,frameDurations:o,getFrame:n,width:r,height:a}}(t,i(1e3*r.duration))),null!=r.repeatDelay){const n=1e3*r.repeatDelay;h===a.Loop?t=e(t,i(n)):h===a.Oscillate&&(t=function(t,e){const{width:r,height:a,getFrame:n}=t,s=t.frameDurations.slice(),o=s.shift();return s.unshift(i(o+e)),{frameCount:t.frameCount,duration:t.duration+e,frameDurations:s,getFrame:n,width:r,height:a}}(e(t,i(n/2)),i(n/2)))}if(null!=r.startTimeOffset)u=i(1e3*r.startTimeOffset);else if(null!=r.randomizeStartTime){const e=82749913,a=null!=r.randomizeStartSeed?r.randomizeStartSeed:e,s=n(o,a);u=i(s*function(t){return i(t.frameDurations.reduce(((t,e)=>t+e),0))}(t))}else u=i(0);return new s(t,u,h,m)}}}}));
