System.register(["./index-legacy.js"],(function(e,t){"use strict";var n,o,r,l,i,c,a,u,s,f,y,h,m;return{setters:[e=>{n=e.gg,o=e.$,r=e.gh,l=e.gi,i=e.gj,c=e.gk,a=e.ef,u=e.bQ,s=e.gl,f=e.gm,y=e.gn,h=e._,m=e.go}],execute:function(){function b(e,t){if(!e)return;let n;n="CIMTextSymbol"===e.type?e.symbol:e;const o="CIMPolygonSymbol"===e.type;if(n?.symbolLayers)for(const r of n.symbolLayers)if(!(r.colorLocked||o&&(l(r)||i(r)&&r.markerPlacement&&c(r.markerPlacement))))switch(r.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":r.tintColor&&w(t,r.tintColor);break;case"CIMVectorMarker":r.markerGraphics?.forEach((e=>{b(e.symbol,t)}));break;case"CIMSolidStroke":case"CIMSolidFill":w(t,r.color);break;case"CIMHatchFill":b(r.lineSymbol,t)}}function w(e,t){for(const n of e)if(n.join(".")===t.join("."))return;e.push(t)}e({D:function(e,t,n){if(e&&null!=t)if(u(e)){const o=e.symbolLayers;o&&o.forEach((e=>{if(e&&"object"===e.type)switch(n){case"tilt":e.tilt=(e.tilt??0)+t;break;case"roll":e.roll=(e.roll??0)+t;break;default:e.heading=(e.heading??0)+t}}))}else s(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle+=t))},N:async function(e,t){const n=await e.fetchSymbol(t);return n||e.fetchCIMSymbol(t)},R:async function(e,n){if(e&&n)return u(e)?async function(e,n){const o=e.symbolLayers;o&&await f(o,(async e=>async function(e,n){switch(e.type){case"extrude":!function(e,t){e.size="number"==typeof t[2]?t[2]:0}(e,n);break;case"icon":case"line":case"text":!function(e,t){const n=d(t);null!=n&&(e.size=n)}(e,n);break;case"path":!function(e,t){const n=S(t,y,[e.width,void 0,e.height]);e.width=C(t[0],e.width,1,n),e.height=C(t[2],e.height,1,n)}(e,n);break;case"object":await async function(e,n){const{resourceSize:o,symbolSize:r}=await async function(e){const{computeObjectLayerResourceSize:n}=await h((()=>t.import("./symbolLayerUtils-legacy.js")),void 0,t.meta.url),o=await n(e,10),{width:r,height:l,depth:i}=e,c=[r,i,l];let a=1;for(let t=0;t<3;t++){const e=c[t];if(null!=e){a=e/o[t];break}}for(let t=0;t<3;t++)null==c[t]&&(c[t]=o[t]*a);return{resourceSize:o,symbolSize:c}}(e),l=S(n,o,r);e.width=C(n[0],r[0],o[0],l),e.depth=C(n[1],r[1],o[1],l),e.height=C(n[2],r[2],o[2],l)}(e,n)}}(e,n)))}(e,n):void(s(e)&&function(e,t){const n=d(t);if(null!=n)switch(e.type){case"simple-marker":e.size=n;break;case"picture-marker":{const t=e.width/e.height;t>1?(e.width=n,e.height=n*t):(e.width=n*t,e.height=n);break}case"simple-line":e.width=n;break;case"text":e.font.size=n}}(e,n))},g:function(e,t,n){e&&(t||null!=n)&&(t&&(t=new o(t)),u(e)?k(e,t,n):s(e)&&function(e,t,n){(t=t??e.color)&&(e.color=g(t,n)),null!=n&&"outline"in e&&e.outline?.color&&(e.outline.color=g(e.outline.color,n))}(e,t,n))},h:function(e,t){if(!e)return null;let l=null;return u(e)?l=function(e){const t=e.symbolLayers;if(!t)return null;let n=null;return t.forEach((e=>{"object"===e.type&&e.resource?.href||(n="water"===e.type?e.color:e.material?e.material.color:null)})),n?new o(n):null}(e):s(e)&&(l="cim"===e.type?function(e){const t=[];return b(n(e),t),t.length?new o(r(t[0])):null}(e):e.color?new o(e.color):null),l?g(l,t):null}}),new a(1e3),new o([128,128,128]);const p=new o("white");function g(e,t){if(null==t||null==e)return e;const n=e.toRgba();return n[3]=n[3]*t,new o(n)}function k(e,t,n){const o=e.symbolLayers;if(!o)return;const r=e=>g(t=t??e??(null!=n?p:null),n);o.forEach((e=>{if("object"!==e.type||!e.resource?.href||t)if("water"===e.type)e.color=r(e.color);else{const t=null!=e.material?e.material.color:null,o=r(t);null==e.material?e.material=new m({color:o}):e.material.color=o,null!=n&&"outline"in e&&null!=e.outline?.color&&(e.outline.color=g(e.outline.color,n))}}))}function d(e){for(const t of e)if("number"==typeof t)return t;return null}function S(e,t,n){for(let o=0;o<3;o++){const r=e[o];switch(r){case"symbol-value":{const e=n[o];return null!=e?e/t[o]:1}case"proportional":break;default:if(r&&t[o])return r/t[o]}}return 1}function C(e,t,n,o){switch(e){case"proportional":return n*o;case"symbol-value":return null!=t?t:n;default:return e}}}}}));
